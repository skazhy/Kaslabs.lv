{% extends "base-adm.html" %}
{% block header %}
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js">
</script>
<script type="text/javascript">
$(document).ready( function () {
	$('.forma').css('display','none');
	$(".venueBlock").css("display","none");
	$(".editButton").click( function() { editForm(this); });
	$(".cancelEdit").click( function() { hideForm(this); });
	$(".venueKey").change( function() { addVenue(this); });
});

function editForm(button) {
	$(button).parent().siblings().css("display","block");
	$(button).parent().css("display","none");
};

function hideForm(button) {
	$(button).parent().siblings().css('display','block');
	$(button).parent().css('display','none');
};

function addVenue(form) {
	var selectValue = $('select option:selected').attr('value');
	var block = $(form).siblings('.venueBlock');
	if (selectValue == 'createNew') $(block).css('display','block');
	else $(block).css('display','none');
};

</script>
<style type="text/css">
.cancelEdit, .editButton {
	text-decoration:underline;
	color:navy;
}
.formContainer {
	border-bottom: 1px solid black;
}
textarea {
	display: block;
}
</style>
{% endblock %}
{% block adm-content %}
	<div id="formWrapper">
	{% for event in events %}
	<div class="formContainer">
	<form action="/admin/store_edit" class="forma" method="post" >
		<input type="hidden" value="{{ event.key }}" name="eventKey" />
			<input type=text" name="eventTitle" value="{{ event.title }}" />
			<select name="venueKey" class="venueKey">
			{% for venue in venues %}
				<option value="{{ venue.key }}"
				{% ifequal venue.key event.venue.key %}
					selected="selected"
				{% endifequal %}
				>{{ venue.title }}</option>
			{% endfor %}
				<option value="createNew">Izveidot jaunu...</option>
			</select>
			<textarea name="eventInfo" rows="8" cols="40">{{ event.information }}</textarea><br />
			<span>Year:</span><input type="text" name="eventY" value = "{{ event.date.year }}" />
			<span>Month:</span><input type="text" name="eventM" value = "{{ event.date.month }}" />
			<span>Day:</span><input type="text" name="eventD" value = "{{ event.date.day }}" />
		<div class="venueBlock">
			<span>New Venue:</span><input type=text" name="venueTitle" value="" />
			<span>Venue city: </span><input type=text" name="venueCity" value="" />
			<span>Venue address: </span>
			<div><textarea name="venueAddress"></textarea>
			<span>Venue Webpage: </span><input type=text" name="venueWeb" value="" />
		</div>
	<p><input type="submit" value="Edit event" /></p>
	<p class="cancelEdit">[ Atcelt rediģēšanu ]</p>
	</form>
	<div class="formPreview">
		<p>Pasākuma nosaukums: {{ event.title }}</p>
		<p>Apraksts: {{ event.information }}</p>
		<p>Datums: {{ event.date.year }}/{{ event.date.month}}/{{ event.date.day }}</p>
		<p>Norises vieta: {{ event.venue.title }}</p>
		<p class="editButton">[ Rediģēt pasākumu ]</p>
	</div>
	</div>
	{% endfor %}
	</div>
{% endblock %}
